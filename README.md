# 리눅스 명령어 중에서 top, ps, jobs, kill 명령어에 대해서 조사해보자!
---
## top와 ps를 알기 전에 알아야 하는 것
```
 PID     :프로세스 아이디
  
 USER    :프로세스 소유자
  
 PR      :실행우선순위
  
 NI      :실행우선순위 (Nice Value)
  
 VIRT    :프로세스 사이즈 (KB)
  
 RES     :프로세스가 사용하는 메모리
  
 SHR     :프로세스가 사용하는 공유 메모리
  
 S       :프로세스의 상태
  
 %CPU    :프로세스가 사용하는 CPU 사용률
    
 %MEM    :프로세스가 사용하는 메모리 사용률
  
 TIME+   :1/100초 단위 프로세스 실행시간
  
 COMMAND : 프로세스 명령어
 ```
---
## top 란?

>실시간으로 CPU 사용률을 체크해주는 도구로 윈도우의 작업관리자랑 비슷
>주로 리눅스를 사용하는 서버의 성능이나 현재 돌아가고 있는 상황을 볼 때 사용
> **NOTE:**
>###### top를 쳤을 때 윗 줄부터 나오는 순서
>###### 1. 시스템 현재시간, 서버 구동시간, 현재 접속 유저수, 로드 에버리지
>###### 2. 현재프로세스들의 상태(Tasks)를 나타내며 전체프로세스(total) 수, 실행중(running) 수, 대기중(sleeping) 수, 종료(stoppde) 수,좀비(zombie) 수
>###### 3. CPU사용량을 나타내며 사용자 프로세스(us), 커널 프로세스(sy), 프로세스 우선순위(ni), 사용안하는 비율(id), IO완료기다리는 비율(wa), 소프트웨어 인터럽트(si), VM에 할당된 비율(st) 
>###### 4. 총 메모리 양(total), 사용가능 메모리 양(free), 사용중 메모리 양(used), 커널 버퍼 사용메모리 양(buff/cache), 물리적 메모리 양(avail Mem)을 출력하여 CPU 사용률을 보여줌.

## top 명령어
```
-a    프로세스를 메모리사용률로 정렬하여 표시 (기본은 CPU사용률 정렬)

-d    [초] 화면갱신시간을 입력받은 초단위로 처리 (기본은 3초마다 갱신)

-i    idle 프로세스와 좀비프로세스를 표시하지 않도록 처리

-u    [사용자] 입력된 사용자의 프로세스만 표시
```

## top 실행화면에서 프로세스의 정렬 기준을 변경
```
 SHIFT + M  메모리 사용률 정렬
 SHIFT + N  PID 기준 정렬
 SHIFT + P  CPU 사용률 정렬
 SHIFT + T  실행시간 기준 정렬
 SHIFT + R  정렬 기준변경
 ```
---
## ps 란, 

>현재 실행중인 프로세스 목록과 상태를 보여줌.

## ps 명령어
```
-a :  세션 리더와 터미널과 연관이 없는 프로세스를 제외한 모든 프로세스를 출력
-d :	세션 리더를 제외한 모든 프로세스들을 출력
-r :  실행 프로세스만 출력
-x :  BSD 스타일로서 혼자 사용되면 사용자에 의해 소유된 모든 프로세스를 출력하고 a 옵션과 함께 사용되어 모든 프로세스를 출력
-l :  상세한 내용을 출력
-f :  완전한 형식의 목록을 출력
-h :  메뉴는 보여주지 않음.(PID, TTY, STAT, TIME, COMMAND 등).
-j :  작업에 관련된 ID를 출력
-l :  -j 옵션보다 자세하게 정보를 출력
-u :  사용자 친화적인 형식으로 출력
-f :  프로세스 간 상속관계를 트리구조로 출력
-n :  사용자의 정보를(모든 형식의 UID와 GID를 포함하여) 숫자로 표시
-w :  출력결과를 생략하지 않고 넓게 출력
```
## 사용중인 프로세스 조회
```
 ps -e
 ps ax
 ps aux
```
## 특정 프로세스 조회
```
ps aux | grep mysqld
```
## 전체 프로세스 끊어서 보기
```
 ps ax | more
```
---
## jobs 란,

>백그라운드로 실행된 프로그램이나 "<Ctrl> + z"를 입력하여 실행한 프로그램에 대해서 확인해줌.

## jobs 명령어
```
-p :	백그란운드에 있는 프로세스의 프로세스 아이디(PID)만 출력
-l :	백그라운드에 있는 프로세스의 프로세스 아이디(PID)를 함께 출력
-s :	백그라운드에 있는 프로세스 중 멈춰있는 프로세스만 출력
-r :	백그라운드에 있는 프로세스 중 실행중인 프로세스만 출력
-n :	상태 변화를 일으킨 작업만을 보여줌.
```  
---
## kill 이란,
  
>대부분 프로세스를 죽일때(종료시킬때) 사용합니다. 하지만 내부적으로는 프로세스에 시그널을 보내 원하는 작업을 하게 하는 명령어
>kill, killall 및 pkill은 지정된 신호를 지정된 프로세스 또는 프로세스 그룹에 보냄.
>신호가 지정되지 않은 경우 각 도구는 15(TERM)를 전송
  
## kill 명령어 사용법
> **NOTE:**

>- 1(-HUP)  :  프로세스를 다시 로드합니다.

>- 9(-Kill) :  프로세스를 죽입니다.

>- 15(-TERM):  프로세스를 정상적으로 중지합니다.

>- l        :  옵션을 사용하여 사용 가능한 모든 신호를 나열

>- pidof    :  브라우저의 응답이 없으면 브라우저 프로세스를 중지해야 할 때, 프로세스 ID를 찾으려면 pidof 명령을 사용
  
>- killall  :  명령은 지정된 이름과 일치하는 모든 프로그램을 종료
>- pkill    :  명령줄에 지정된 패턴과 일치하는 프로세스를 종료

### 신호는 세 가지 방법으로 지정할 수 있습니다. 
```
- 숫자를 사용

- "SIG"   접두사를 사용

- "SIG"   접두사 없이 사용

```
 ### 프로세스 죽이는 법
 #### ex) node.js로 실행 중인 서버를 죽이고 싶다면 
  ```
	$ kill [pid]
  ```
![2023-05-24](https://github.com/PYOWAR/OPSW_test/assets/133829499/821b0609-5fec-4c45-bd3e-5cfeb365c1da)
#### ps 명령어를 통해 node.js의 pid를 얻고 kill 명령어의 파라미터로 넘겨 실행시키면 종료시킬 수 있음.
  
### 사용자 지정 시그널 전송 방
kill 명령어의 default 시그널은 TERM(15) 이지만 -s 명령으로 다른 시그널을 보낼 수 있음.
```
$ kill -s [signal] [pid]
```
예를 들어 프로세스가 TERM(15) 시그널에 응답하지 않으면 다음의 명령어 처럼 KILL(9)를 사용해 강제로 죽일 수 있습니다.
```
 $ kill -s KILL [pid]
```
```
 $ kill -s KILL [pid] $ kill -s SIGKILL [pid] $ kill -s 9 [pid] $ kill -9 [pid]
```
 위의 명령어에서 숫자는 -l 명령어를 통해 알아낼 수 있습니다.

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
